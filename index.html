<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>æ—å®è»’ & é™³ä»²è–‡ å®¶å®´é‚€è«‹</title>
  <style>
    /* ç°¡å–®æ¨£å¼é‡ç¾ç²‰ç´…å¡ç‰‡è¨­è¨ˆ */
    :root {
      --pink-1: #ffd7e6;
      --pink-2: #f7c0d1;
      --accent: #e21f4d;
      --card-bg: #fff;
      --radius: 12px;
    }
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Helvetica Neue", Arial, "Microsoft JhengHei", sans-serif;
      background:
        linear-gradient(180deg, rgba(255, 215, 230, 0.85), rgba(255, 255, 255, 0.85) 40%),
        url('./lovepik.png') repeat fixed;
      background-size: 150px auto;
      padding: 24px;
      color: #333;
      min-height: 100vh;
      margin: 0;
    }
    .container {
      max-width: 600px;
      margin: 0 auto;
    }
    .card {
      background: var(--card-bg);
      border-radius: var(--radius);
      box-shadow: 0 6px 18px rgba(0,0,0,0.06);
      padding: 18px;
      margin-bottom: 18px;
    }
    h1.title {
      color: var(--accent);
      margin: 0 0 12px;
      font-size: 22px;
      text-align: center;
    }
    h2 {
      color: var(--accent);
      margin: 0 0 8px;
      font-size: 18px;
    }
    label { 
      display: block; 
      margin: 12px 0 6px; 
      font-weight: 600; 
      color: #8b2b48; 
    }
    input[type="text"], input[type="email"], input[type="number"], textarea, select {
      width: 100%;
      padding: 10px 12px;
      border: 1px solid #eee;
      border-radius: 8px;
      box-sizing: border-box;
      background: #fff;
      font-size: 14px;
    }
    input:focus, textarea:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 2px rgba(226, 31, 77, 0.1);
    }
    .radio-group { 
      display: flex; 
      gap: 12px; 
      align-items: center; 
      margin-top: 6px; 
    }
    .radio-group label {
      display: flex;
      align-items: center;
      margin: 0;
      font-weight: normal;
      gap: 6px;
    }
    .btn {
      display: block;
      background: linear-gradient(180deg, var(--accent), #b10d36);
      color: white;
      border: none;
      width: 100%;
      padding: 12px 16px;
      border-radius: 10px;
      font-size: 16px;
      cursor: pointer;
      margin-top: 14px;
      transition: transform 0.2s;
    }
    .btn:hover {
      transform: translateY(-1px);
    }
    .btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }
    .muted { 
      color: #888; 
      font-size: 13px; 
      margin-top: 8px;
    }
    .status {
      padding: 8px 12px;
      border-radius: 6px;
      margin-top: 8px;
      font-size: 14px;
    }
    .status.success {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }
    .status.error {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }
    .status.loading {
      background: #d1ecf1;
      color: #0c5460;
      border: 1px solid #bee5eb;
    }
    /* Album card */
    .album-empty {
      border: 2px dashed #f2c9d8;
      padding: 30px;
      border-radius: 10px;
      text-align: center;
      color: #c66;
    }
    .pa-carousel-widget {
      border-radius: 8px;
      overflow: hidden;
    }
    /* éŸ¿æ‡‰å¼è¨­è¨ˆ */
    @media (max-width: 480px) {
      body {
        padding: 12px;
      }
      .card {
        padding: 12px;
      }
      h1.title {
        font-size: 20px;
      }
    }
  </style>
  <!-- publicalbum è¼‰å…¥ -->
  <script src="https://cdn.jsdelivr.net/npm/publicalbum@latest/embed-ui.min.js" async></script>
</head>
<body>
  <div class="container">

    <h1 class="title">ğŸ‰ å®è»’ä»²è–‡æ•¬é‚€åƒåŠ å®¶å®´</h1>

    <!-- å©šå®´é‚€è«‹è³‡è¨Šå¡ç‰‡ -->
    <div class="card" style="text-align: center; background: linear-gradient(135deg, var(--pink-1), #fff9fc);">
      <h2 style="color: var(--accent); margin-bottom: 16px;">ğŸ’• å–œå¸–</h2>
      
      <div style="line-height: 1.8; color: #5d1a2e; font-size: 15px;">
        <p style="margin: 8px 0; font-weight: 600;">è¬¹è¨‚æ–¼æ°‘åœ‹114å¹´11æœˆ29æ—¥</p>
        <p style="margin: 8px 0;">ï¼ˆæ˜ŸæœŸå…­ï¼Œè¾²æ›†ç”²è¾°å¹´åæœˆå»¿ä¹æ—¥ï¼‰</p>
        <p style="margin: 8px 0; font-weight: 600; color: var(--accent);">èˆ‰è¡Œå®¶å®´</p>
        
        <div style="margin: 16px 0; padding: 12px; background: rgba(255, 255, 255, 0.7); border-radius: 8px;">
          <p style="margin: 4px 0;"><strong>æ–°éƒï¼š</strong>æ—å®è»’ å…ˆç”Ÿ</p>
          <p style="margin: 4px 0;"><strong>æ–°å¨˜ï¼š</strong>é™³ä»²è–‡ å°å§</p>
        </div>
        
        <div style="margin: 16px 0; text-align: left; background: rgba(255, 255, 255, 0.7); padding: 12px; border-radius: 8px;">
          <p style="margin: 4px 0;"><strong>ğŸ¢ å®´å®¢åœ°é»ï¼š</strong>é©¥åœ’å·èœé¤å»³</p>
          <p style="margin: 4px 0;"><strong>ğŸ• å®´å®¢æ™‚é–“ï¼š</strong>ä¸­åˆ12æ™‚00åˆ†å…¥å¸­</p>
          <p style="margin: 4px 0;"><strong>ğŸ“ åœ°å€ï¼š</strong>106å°åŒ—å¸‚å¤§å®‰å€æ•¦åŒ–å—è·¯1æ®µ324è™Ÿ</p>
          <p style="margin: 8px 0 4px;"><strong>ğŸ—ºï¸ é¤å»³ä½ç½®ï¼š</strong></p>
          <a href="https://share.google/7VAaVfcyfAggRWBpj" target="_blank"
             style="color: var(--accent); text-decoration: none; font-weight: 600;
                    display: inline-block; padding: 6px 12px; background: rgba(226, 31, 77, 0.1);
                    border-radius: 6px; transition: background 0.2s;"
             onmouseover="this.style.background='rgba(226, 31, 77, 0.2)'"
             onmouseout="this.style.background='rgba(226, 31, 77, 0.1)'">
            ğŸŒ Google åœ°åœ–ä½ç½®
          </a>
        </div>
        
        <p style="margin: 16px 0 8px; font-weight: 600; color: var(--accent); font-size: 16px;">
          èª æ‘¯é‚€è«‹é—”åºœå…‰è‡¨
        </p>
        <p style="margin: 0; font-size: 13px; color: #888;">æ•¬é‚€</p>
      </div>
    </div>

    <!-- ç›¸ç‰‡é›†å¡ç‰‡ï¼ˆä½¿ç”¨ publicalbum åµŒå…¥ Google Photos åˆ†äº«ç›¸ç°¿ï¼‰ -->
    <div class="card">
      <h2>ğŸ“· å°å°èŠ±çµ®</h2>
      
      <!-- publicalbum åµŒå…¥èªæ³• -->
      <div style="margin-top:12px;">
        <div class="pa-carousel-widget" style="width:100%; height:480px; display:block;"
             data-link="https://photos.app.goo.gl/MrS4JA9gjTjm1GdZ6"
             data-title="ğŸ“¸"
             data-description="å…±äº«ç›¸ç°¿ Â· é»æ“ŠæŸ¥çœ‹ï¼">
          <object data="https://lh3.googleusercontent.com/pw/AP1GczPCx3Aef4tlt6doIKqPjTFgL02eNmzS8YyK9gwqzwTPkQC-xCec5dkGmnjNOJ4sCMSmMaR9zs3ulCrdT27s7DTrFdDFROGA2_AULxT20DznGCGMNRYw=w1920-h1080"></object>
          <object data="https://lh3.googleusercontent.com/pw/AP1GczNN08ulSwp0nniWIvgVBupota5KZY2xVf7eu8Ujtj5Pyn5759UMtYndbO_YHGzpzcwRk1DgCvTvxhxaDYefDjPaNMxZN8BaFXHJVLUa0qWLTQSsiOn0=w1920-h1080"></object>
          <object data="https://lh3.googleusercontent.com/pw/AP1GczPoarRfqi4BE1yBHzbR1yqIwleLxg9zQvpw9AUgGpIXWISrx1N6bmoWonKyKz61jqbsv-flDFu4j06BoKPwae7FgllS4NFx0K-R83EDsqno0wTGsz_p=w1920-h1080"></object>
          <object data="https://lh3.googleusercontent.com/pw/AP1GczNwuYAA8V1YCRW6K_IhNn8reutu1uRxksSJAh6LUra650D3ft0JXVP25Ep_xdhcfLCA2YP5-e-RureG5-tBGvVpYBW_lek8GjkRU8o49vZzxRiX7Zz5=w1920-h1080"></object>
          <object data="https://lh3.googleusercontent.com/pw/AP1GczMSerFzBr82GcfU9jlDOM05bLesU8O6Tkww78XYFedC-aKkZd1HRqktykhUSo6pWEwnyzxCvvZBUO4YMVICmgkID4SzM-UuJ0KTHi2hNT1AwI7BeT7v=w1920-h1080"></object>
          <object data="https://lh3.googleusercontent.com/pw/AP1GczPPZkOLWQAgTfI7whgFk-gS3MuW3YYfdgL6-GMOS-YmycaGgS3kDLE8II9TDNB7MUUktYw7ytxLyDs5xDafyjAuJxywU-tjyO3aNTvOXEx7RdW4p1N8=w1920-h1080"></object>
          <object data="https://lh3.googleusercontent.com/pw/AP1GczN7UzwwsmHfxfOofyzfmSVb_91H6gjyEj_A_Iy8-9M2D7Eqz4Ouaqczv-BEqc9eHLvKd8sJocaxCDtugfGxmoOFbY2nFoPwgbz_QI1JKovWZwfa2MrR=w1920-h1080"></object>
          <object data="https://lh3.googleusercontent.com/pw/AP1GczMoilzWhylQIwkGezZTb5Ad1qDBgzd0SsvQCoXD6iv6YHlLx4OpmjoYo140D05ZeJxDq2xDMLiBgEcYWIQdmmqxrrT7Qc1HgDVft76cHuOriyS2d5-g=w1920-h1080"></object>
          <object data="https://lh3.googleusercontent.com/pw/AP1GczOdY16WOFBoEV83ckQ6ypVxeAAir-ZoA7pNkLWc25YQV3lUJ-0kpmxRoChA-6hBa1DKlV_XYL7InbxRxcH9Rcytl5nwoNE_xtORZHptkE2G1vVd8rmk=w1920-h1080"></object>
          <object data="https://lh3.googleusercontent.com/pw/AP1GczN2r-TwTesv_hqfJTRh9VM49yMLziVzAXd6HX1o6XEk-ZOeEJpcZJaZLAlCuQB_s9q9nljbUnELJSo9X_OUtkPtQxG7qeG-EwL5DWEOYvFd--nH00JZ=w1920-h1080"></object>
          <object data="https://lh3.googleusercontent.com/pw/AP1GczO4DVUUM3scbAMomT5wMTTdr2azItYWg9036FbsER7TZNCU-o5hX4cr5LDAIf2-JLgK2De6svLbHpBYbgzrJIe6lI3z4Fwy-AKZ1Vjnpt5wNR1cmAhA=w1920-h1080"></object>
          <object data="https://lh3.googleusercontent.com/pw/AP1GczMZEEsSZgLmmmSYkDFTGtJZ7fTDJfesTL2kjoZKGC61rpciUXE2iFZT9OSwU0kRGmdKA1z0yRRd4PLCp_wtBwmi7pTdm5f6rkOauHWaC3k5wK8ODPVu=w1920-h1080"></object>
          <object data="https://lh3.googleusercontent.com/pw/AP1GczMZ_ONLZD_DmUbsHF0yQhhS-Q8q5dsWRA5v2lLr1JCLLGwcqieUDmNskc6o2761Oj0HIoZ-7RsG2m53a72s7HrkawVArt-v_QiKnIJ3qUExmHWE-MEx=w1920-h1080"></object>
          <object data="https://lh3.googleusercontent.com/pw/AP1GczMQ9eCYAYee9U5jNwrvMNhjPC6OxyVTEtDZ_KGv94SZ7wSgF9xtclodGhOnracOFgQlmdWHErJH_6FSUU3lpYlpwtF7P_IHoHV4IBBfGihTZ6hOacyn=w1920-h1080"></object>
          <object data="https://lh3.googleusercontent.com/pw/AP1GczNLo1oW_s-sUxBcao33cX361Uy3tpNAg2JEb5xF7xyIUZE1qESph3SM0pwhL-g1UijupLLRzinCu2_Fwif7OMKidyjRxkLbhcGh6nwKovFWht3A10u6=w1920-h1080"></object>
          <object data="https://lh3.googleusercontent.com/pw/AP1GczMGIxI2ABIajVjs-XQOYmfgl3YyS29E5YO1da6bXoAse7-F_kvTzKySAM7hCWQM_QWLYkiAit_U4ufyuWFl5uSQ0oPN1fJY7JAIaloRaQftGMyhccz5=w1920-h1080"></object>
          <object data="https://lh3.googleusercontent.com/pw/AP1GczPeakDtHrjRJDmB5BaNcORIZ9ClYQbPTg7Dq4DctuyMBsFIB2wFuNLEp8bcynQ2Tai7j-H8Pg6ZriDQ3JRQd433gxlz56zyxVozmEsW6GgEZQD0Woia=w1920-h1080"></object>
          <object data="https://lh3.googleusercontent.com/pw/AP1GczMXUVabb185AGIdYLQdh8UX--ajNwQ8x8ZA66L27grzaQSTB3QDH64w070Bpq3C9V1MHa1zQVc7dsdaR0qwFhPwWYkVAKA8Ez1UIxF_aiSyKU1EejTx=w1920-h1080"></object>
          <object data="https://lh3.googleusercontent.com/pw/AP1GczPB3Zo67PTl3ta3OKlzJ_4cy8qaDd1ul7pBy-V6h07LLsERMtIn93fYqbM3MM6MsbWtBnI7uN8p66yD0AlCabDIE2mw7F8DwfbMDKXJud93vh5U_t-F=w1920-h1080"></object>
          <object data="https://lh3.googleusercontent.com/pw/AP1GczNIGMej80GKCgfu9HqZARpggK1hyiInOEj4PKGijTqHTCUOH0sRkv0yjMRedHlIyvkHtcsPNOpyBjJ035QSrkxaomxQF5A5bNMZ6NAENU7eHXUKcw_w=w1920-h1080"></object>
        </div>
      </div>
    </div>

    <!-- RSVP è¡¨å–® -->
    <div class="card">
      <h2>ğŸ“ å›è¦† RSVP</h2>
      <p class="muted">è«‹å¡«å¯«ä»¥ä¸‹è³‡è¨Šï¼Œè®“æˆ‘å€‘çŸ¥é“æ‚¨æ˜¯å¦åƒåŠ å®¶å®´</p>
      <form id="rsvpForm">
        <label>å§“å *</label>
        <input name="name" type="text" placeholder="è«‹è¼¸å…¥æ‚¨çš„å§“å" required />

        <label>Email</label>
        <input name="email" type="email" placeholder="ä¾‹å¦‚ï¼šname@example.comï¼ˆç”¨æ–¼å†æ¬¡ç·¨è¼¯èˆ‡é€šçŸ¥ï¼‰" />

        <label>æ˜¯å¦åƒåŠ  *</label>
        <div class="radio-group">
          <label><input type="radio" name="attend" value="yes" checked /> æ˜¯ï¼Œæˆ‘æœƒåƒåŠ </label>
          <label><input type="radio" name="attend" value="no" /> ä¸ï¼Œæˆ‘ç„¡æ³•åƒåŠ </label>
        </div>

        <label>å‡ºå¸­äººæ•¸ *</label>
        <input name="num_people" type="number" min="1" max="20" value="1" required />
        <p class="muted">åŒ…å«æ‚¨æœ¬äººåœ¨å…§çš„ç¸½äººæ•¸</p>

        <label>å‚™è¨»ï¼ˆé¸å¡«ï¼‰</label>
        <textarea name="note" rows="3" placeholder="ä¾‹å¦‚ï¼šæ˜¯å¦æ”œå¸¶å°æœ‹å‹ã€é£²é£Ÿé™åˆ¶ã€äº¤é€šå®‰æ’ç­‰"></textarea>

        <button class="btn" type="submit" id="submitBtn">é€å‡ºå›è¦†</button>
        <div id="formStatus"></div>
      </form>
    </div>

    <!-- çµ±è¨ˆè³‡è¨Šå¡ç‰‡ -->
    <div class="card" id="statsCard" style="display: none;">
      <h2>ğŸ“Š ç›®å‰çµ±è¨ˆ</h2>
      <div id="statsContent">
        <p class="muted">è¼‰å…¥ä¸­...</p>
      </div>
    </div>

    <!-- é å°¾ -->
    <div class="card" style="text-align: center; background: linear-gradient(135deg, var(--pink-1), var(--pink-2));">
      <p style="margin: 0; color: var(--accent); font-weight: 600;">
        ğŸ’ æœŸå¾…èˆ‡æ‚¨å…±åº¦ç¾å¥½æ™‚å…‰ï¼
      </p>
    </div>

  </div>

  <script>
    // å·²é…ç½®æ‚¨çš„ Apps Script Web App URL å’Œ Secret Token
    const WEBAPP_URL = "https://script.google.com/macros/s/AKfycbz0wuk7Rl8iVd6ox54mFERkPJGSazPeoM32sZx4X2ybOlHd0eG8cwvaMoBsR2o2Tn8/exec?token=rsvp_secret_2025_aB9kL3mN7qR4tW8xY2zA5fH6jK9nP3sV1xC7eG2mQ8vR4tY7zB9kL3nP6sW1xY4zA7fH9jK2mQ5tR8vB1xC4eG7j";

    const form = document.getElementById('rsvpForm');
    const statusEl = document.getElementById('formStatus');
    const submitBtn = document.getElementById('submitBtn');

    // è¡¨å–®æäº¤è™•ç†
    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      
      // æª¢æŸ¥æ˜¯å¦è¨­å®šäº†æ­£ç¢ºçš„ URL
      if (WEBAPP_URL.includes('YOUR_DEPLOY_ID') || WEBAPP_URL.includes('YOUR_SECRET_TOKEN')) {
        showStatus('è«‹å…ˆè¨­å®š Google Apps Script çš„éƒ¨ç½² URL å’Œå¯†é‘°', 'error');
        return;
      }

      showStatus('æ­£åœ¨é€å‡º...', 'loading');
      submitBtn.disabled = true;

      const data = {
        name: form.name.value.trim(),
        email: form.email.value.trim(),
        attend: form.attend.value,
        num_people: parseInt(form.num_people.value),
        note: form.note.value.trim()
      };

      try {
        const res = await fetch(WEBAPP_URL, {
          method: 'POST',
          headers: { 
            'Content-Type': 'application/json',
            'Accept': 'application/json'
          },
          body: JSON.stringify(data)
        });

        const responseText = await res.text();
        let result;
        
        try {
          result = JSON.parse(responseText);
        } catch (parseError) {
          throw new Error('ä¼ºæœå™¨å›æ‡‰æ ¼å¼éŒ¯èª¤');
        }

        if (result.status === 'ok') {
          showStatus('âœ… é€å‡ºæˆåŠŸï¼Œè¬è¬æ‚¨çš„å›è¦†ï¼', 'success');
          form.reset();
          
          // 3ç§’å¾Œè¼‰å…¥çµ±è¨ˆè³‡è¨Š
          setTimeout(() => {
            loadStats();
          }, 3000);
        } else {
          showStatus('âŒ é€å‡ºå¤±æ•—ï¼š' + (result.error || 'æœªçŸ¥éŒ¯èª¤'), 'error');
        }
      } catch (err) {
        console.error('Form submission error:', err);
        showStatus('âŒ ç¶²è·¯éŒ¯èª¤ï¼š' + err.message, 'error');
      } finally {
        submitBtn.disabled = false;
      }
    });

    // é¡¯ç¤ºç‹€æ…‹è¨Šæ¯
    function showStatus(message, type) {
      statusEl.innerHTML = `<div class="status ${type}">${message}</div>`;
      if (type === 'success') {
        setTimeout(() => {
          statusEl.innerHTML = '';
        }, 5000);
      }
    }

    // è¼‰å…¥çµ±è¨ˆè³‡è¨Šï¼ˆå¯é¸åŠŸèƒ½ï¼‰
    async function loadStats() {
      try {
        const statsUrl = WEBAPP_URL.replace('?token=', '?action=list&token=');
        const res = await fetch(statsUrl);
        const data = await res.json();
        
        if (Array.isArray(data)) {
          displayStats(data);
        }
      } catch (err) {
        console.log('ç„¡æ³•è¼‰å…¥çµ±è¨ˆè³‡è¨Šï¼š', err.message);
      }
    }

    // é¡¯ç¤ºçµ±è¨ˆè³‡è¨Š
    function displayStats(responses) {
      const totalResponses = responses.length;
      const attendingCount = responses.filter(r => r.attend === 'yes').length;
      const totalPeople = responses
        .filter(r => r.attend === 'yes')
        .reduce((sum, r) => sum + (parseInt(r.num_people) || 0), 0);

      const statsContent = document.getElementById('statsContent');
      statsContent.innerHTML = `
        <p><strong>ç¸½å›è¦†æ•¸ï¼š</strong>${totalResponses} äºº</p>
        <p><strong>ç¢ºå®šåƒåŠ ï¼š</strong>${attendingCount} äºº</p>
        <p><strong>é è¨ˆå‡ºå¸­ç¸½äººæ•¸ï¼š</strong>${totalPeople} äºº</p>
      `;
      
      document.getElementById('statsCard').style.display = 'block';
    }

    // publicalbum åˆå§‹åŒ–ï¼šç›¸ç°¿ç¾åœ¨æœƒç›´æ¥é¡¯ç¤º
    window.addEventListener('pa-widget-ready', function(e) {
      // publicalbum æˆåŠŸè¼‰å…¥ widget å¾Œæœƒè§¸ç™¼æ­¤äº‹ä»¶
      console.log('ç›¸ç°¿å·²è¼‰å…¥å®Œæˆ');
    });

    // é é¢è¼‰å…¥å®Œæˆå¾Œå˜—è©¦è¼‰å…¥çµ±è¨ˆè³‡è¨Šï¼ˆå¦‚æœéœ€è¦ï¼‰
    window.addEventListener('DOMContentLoaded', function() {
      // å¯ä»¥åœ¨é€™è£¡æ·»åŠ åˆå§‹åŒ–é‚è¼¯
    });
  </script>
</body>
</html>